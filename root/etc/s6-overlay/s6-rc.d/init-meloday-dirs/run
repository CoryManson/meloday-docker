#!/usr/bin/with-contenv bash
# shellcheck shell=bash

# Ensure meloday.py exists in /app; copy it from /tmp and make it executable if missing
if [[ ! -f /app/meloday.py ]]; then
    cp /tmp/meloday.py /app/meloday.py
    chmod +x /app/meloday.py
fi

# Ensure moodmap.json exists in /app; copy it from /tmp if missing
if [[ ! -f /app/moodmap.json ]]; then
    cp /tmp/moodmap.json /app/moodmap.json
fi

# Ensure the assets directory symlink exists in /app; create it if missing
if [[ ! -d /app/assets/ ]]; then
    ln -s /config/assets /app/assets
fi

# Ensure the config.yml symlink exists in /app; create it if missing
if [[ ! -f /app/config.yml ]]; then
    ln -s /config/config.yml /app/config.yml
fi
